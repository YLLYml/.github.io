<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文字冒险游戏 - 大王万岁</title>
    <style>
        /* 全局样式重置，消除默认边距 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "微软雅黑", "宋体", sans-serif;
        }
        /* 页面背景，整体居中 */
        body {
            background-color: #f0e6d2;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative; /* 为烟花画布定位 */
            overflow: hidden; /* 隐藏溢出的烟花 */
        }
        /* 烟花画布样式 */
        #fireworksCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: auto; /* 允许点击触发烟花 */
            z-index: 10; /* 放在游戏容器下方，不遮挡文字 */
            background: rgba(0, 0, 0, 0.95); /* 更深的背景凸显金红色烟花 */
        }
        /* 游戏主容器，卡片样式 */
        .game-container {
            width: 800px;
            max-width: 100%;
            background-color: rgba(255, 255, 255, 0.95); /* 半透明，能看到烟花 */
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding: 40px;
            position: relative;
            z-index: 20; /* 保证游戏内容在烟花上方 */
            transition: all 0.3s ease; /* 平滑过渡 */
        }
        /* 烟花页面专属容器样式 - 更小更通透 */
        .game-container.fireworks-mode {
            width: 500px; /* 缩小宽度 */
            background-color: rgba(255, 255, 255, 0.8); /* 更通透的背景 */
            padding: 20px; /* 减少内边距 */
        }
        /* 游戏标题 */
        .game-title {
            text-align: center;
            color: #8b4513;
            font-size: 32px;
            margin-bottom: 30px;
            border-bottom: 2px solid #d4b886;
            padding-bottom: 20px;
        }
        /* 烟花页面标题样式 */
        .fireworks-mode .game-title {
            font-size: 24px; /* 缩小标题 */
            margin-bottom: 15px;
            padding-bottom: 10px;
            color: #fff; /* 白色标题更醒目 */
            text-shadow: 0 0 5px #8b4513; /* 文字阴影增强可读性 */
            border-bottom-color: rgba(212, 184, 134, 0.5);
        }
        /* 剧情展示区域 - 核心修改：添加滚动条 */
        .story-box {
            max-height: 300px; /* 最大高度，超出则滚动 */
            height: auto;
            padding: 30px;
            background-color: #faf5eb;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 18px;
            line-height: 1.8;
            color: #333;
            overflow-y: auto; /* 垂直方向自动出现滚动条 */
            /* 美化滚动条 */
            scrollbar-width: thin; /* 火狐：细滚动条 */
            scrollbar-color: #8b4513 #faf5eb; /* 火狐：滚动条颜色 */
        }
        /* 美化Chrome/Edge滚动条 */
        .story-box::-webkit-scrollbar {
            width: 8px; /* 滚动条宽度 */
        }
        .story-box::-webkit-scrollbar-track {
            background: #faf5eb; /* 滚动条轨道颜色 */
            border-radius: 4px;
        }
        .story-box::-webkit-scrollbar-thumb {
            background-color: #8b4513; /* 滚动条滑块颜色 */
            border-radius: 4px; /* 滑块圆角 */
        }
        .story-box::-webkit-scrollbar-thumb:hover {
            background-color: #a0522d; /* 鼠标悬停滑块颜色 */
        }
        /* 烟花页面剧情区域样式 */
        .fireworks-mode .story-box {
            max-height: 200px; /* 烟花模式下的最大高度 */
            min-height: 120px; /* 保留最小高度 */
            padding: 15px;
            background-color: rgba(250, 245, 235, 0.85); /* 更通透 */
            margin-bottom: 15px;
            font-size: 16px;
        }
        /* 选项按钮容器，居中排列 */
        .options-box {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        /* 选项按钮样式，带hover/点击效果 */
        .option-btn {
            padding: 12px 30px;
            background-color: #8b4513;
            color: #fff;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 20;
        }
        .option-btn:hover {
            background-color: #a0522d;
            transform: translateY(-3px);
        }
        .option-btn:active {
            transform: translateY(0);
        }
        /* 输入框相关样式 */
        .input-box {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 20;
        }
        .answer-input {
            padding: 12px 20px;
            width: 300px;
            border: 2px solid #d4b886;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
        }
        .answer-input:focus {
            border-color: #8b4513;
        }
        .submit-btn {
            padding: 12px 30px;
            background-color: #8b4513;
            color: #fff;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 20;
        }
        .submit-btn:hover {
            background-color: #a0522d;
            transform: translateY(-3px);
        }
        .submit-btn:active {
            transform: translateY(0);
        }
        /* 错误提示样式 */
        .error-tip {
            color: #ff4444;
            font-size: 14px;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
            position: relative;
            z-index: 20;
        }
        /* 游戏结束样式 */
        .end-text {
            text-align: center;
            color: #666;
            font-size: 20px;
            font-weight: bold;
            position: relative;
            z-index: 20;
        }
        /* 祝福语样式，更醒目 */
        .bless-text {
            color: #8b4513;
            font-weight: bold;
            font-size: 20px;
            text-align: center;
            line-height: 2;
        }
        /* 烟花页面提示文字 */
        .fireworks-tip {
            color: #fff;
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
            text-shadow: 0 0 8px #ff0000;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- 烟花画布 -->
    <canvas id="fireworksCanvas"></canvas>
    
    <div class="game-container" id="gameContainer">
        <h1 class="game-title">大王万岁</h1>
        <div class="story-box" id="storyBox"></div>
        <div class="options-box" id="optionsBox"></div>
    </div>

    <script>
        // ########## 核心：剧情数据 ##########
        const storyData = {
            start: {
                text: "传说，在这个世界上，有一位无所不知，无所不能的YL大王。",
                options: [
                    { text: "继续", next: "start2" }
                ]
            },
            start2: {
                text: "YL大王居住在云海之巅的凌霄殿，<br><br>殿宇由千年美玉雕琢而成，祥云终日环绕，瑞兽日夜守护，<br><br>世间万物的兴衰荣辱，皆在大王的一念之间。",
                options: [
                    { text: "继续", next: "start3" }
                ]
            },
            start3: {
                text: "为了一睹大王的真容，无数冒险者踏上了征程，<br><br>而你，正是其中一员。<br><br>前路漫漫，你站在凌霄殿的山脚，眼前出现了两条截然不同的道路。",
                options: [
                    { text: "继续", next: "start_choose" }
                ]
            },
            start_choose: {
                text: "请选择你要踏上的道路，向着YL大王的凌霄殿出发：",
                options: [
                    { text: "走左边的野花路", next: "flowerRoad" },
                    { text: "走右边的雾水路", next: "fogRoad" },
                    {text:"我不走陆路，我要坐船",next:"takeBoat"}
                ]
            },
            takeBoat: {
                text: "你坐上木船，划到河中央时，船底突然漏水，你掉进了河里，幸好被下游的渔民救起，只能放弃征程，结局：【有惊无险】。",
                options: []
            },
            flowerRoad: {
                text: "你沿着野花路往前走，花香扑鼻，突然一只彩色的小鹿跳到你面前，它叼着一枚发光的浆果，似乎要送给你。你要接过浆果还是转身离开？",
                options: [
                    { text: "什么玩意！让我尝尝！ 接过浆果", next: "getBerry" },
                    { text: "不要吃乱七八糟的东西！ 转身离开", next: "leaveFlower" }
                ]
            },
            fogRoad: {
                text: "你踏入雾水路，雾气渐渐散去，眼前出现一条清澈的小溪，溪边有一个带密码锁的木石门，<br><br>门上刻着：「无所不能的YL大王啊！您的圣诞日我们永远铭记！」。<br><br>请输入密码打开门（格式：xxxx.xx.xx)：",
                inputQuiz: {
                    correctAnswer: "2006.04.07",
                    correctNext: "streamGateOpen",
                    tip: "大王的生日都不记得！愚蠢的人类，你不配面见YL大王！"
                }
            },
            streamGateOpen: {
                text: "密码正确！石门缓缓打开，里面是一条通往山洞的小径，你沿着小径走到山洞门口，洞口的守卫问你：「森林的守护精灵是什么？」请说出答案：",
                inputQuiz: {
                    correctAnswer: "鹿",
                    correctNext: "caveTreasure",
                    tip: "答案错误，森林的守护精灵和大王同名！再试一次～"
                }
            },
            caveTreasure: {
                text: "回答正确！守卫让你进入山洞，里面藏着黄金和宝石，还有一张凌霄殿的近路地图，这时一只小鹿跳出来：“人类我来帮你一程。”小鹿带着你飞向云海。",
                options: [
                   { text: "哇去！这么好！", next: "getBerry2" } 
                ],
            },
            getBerry: {
                text: "你接过浆果，吃下后感觉身体变得轻盈，小鹿带着你飞向云海，<br><br>你看到连绵的群山上雕刻的都是YL大王的圣像。你心中默念YL大王万岁<br><br>此时小鹿问：“既然你想面见无所不知无所不能的YL大王，那人类，我要问问你，YL大王是什么星座的？（输入三字）",
    
                    inputQuiz: {
                    correctAnswer: "白羊座",
                    correctNext: "getBerry2",
                    tip: "大王的星座都不知道！愚蠢的人类，你被扔下高空了！"
                }
                    
            },

            getBerry2: {
                text: "小鹿的速度越来越快，穿过层层云雾，你看到了漫天的霞光，<br><br>小鹿对你说：“贪婪的人类，不要妄想欺骗YL大王。”",
                options: [
                    { text: "欺骗？！我对大王忠心不二！", next: "getBerry3" }
                ]
            },
            getBerry3: {
                text: "“那是最好不过的了......”小鹿缓缓放慢速度，你抬头望去，<br><br>云海之巅，一座金碧辉煌的宫殿矗立在霞光中，正是YL大王的凌霄殿！<br><br>只见门上有这么一串东西：从此门进，即可面见神圣的YL大王。<br><br>_.._ |..  |  _. <br><br>_. |  ..  | ._  | _.<br><br>_._   .._   ._   ..<br><br>._..   .<br><br>你想了想，这或许是个密语？",
                    inputQuiz: {
                    correctAnswer: "新年快乐",
                    correctNext: "getBerry4",
                    tip: "好好想想，不够聪明的人类不配面见YL大王"
                },
            },
            getBerry4: {
                text: "你跟着小鹿踏入凌霄殿，YL大王端坐在玉座之上，目光温和地看着你，<br><br>“你不是第一个来到这里的人！说吧，你来到这里的目的是什么？",
                options: [
                    {text:"我想要获得财富！",next:"caifu"},
                    {text:"我想要获得名誉！",next:"mingyu"},
                    {text:"我只是您的信徒！见到您的真容就是我的无上荣耀！",next:"p1"}
                ]
            },
            caifu:{
                text:"大王看着你，点了点头，随即给了你三根金条。你欣喜若狂，大王大手一挥，你缓缓下降。",
                options: [
                    {text:"太好啦！我有钱啦！",next:"c1",}
                ]
            },
            c1:{
                text:"你回到了最开始的地方，然后你低头发现手里的金条变成了土块。<br><br>达成结局：【南柯一梦】",
                options: []
            },
            mingyu:{
                text:"大王看着你，点了点头，随即答应给你一千万粉丝。你欣喜若狂，大王大手一挥，你缓缓下降。",
                options: [
                    {text:"太好啦！我有名啦！",next:"c2",}
                ]
            },
            c2:{
                text:"你回到了最开始的地方，然后你发现你被人开户后被营销号骂烂了。<br><br>达成结局：【不堪其扰】",
                options: []
            },
            p1: {
                text: "大王听闻你的回答，龙颜大悦：“难得有如此忠心的信徒！<br><br>说出你的名字，吾将赐你专属祝福，护你一生顺遂！”",
                options: [
                    { text: "遵大王旨意，愿献吾名！", next: "inputName" }
                ]
            },
            inputName: {
                text: "请在下方输入你的名字，领取YL大王的专属祝福：（必须要是全名）",
                inputQuiz: {
                    correctAnswer: "*",
                    correctNext: "blessPage",
                    tip: ""
                }
            },
            blessPage: {
                text: "",
                options: [
                    { text: "大王赐福，燃烟花庆喜！", next: "fireworksPage" }
                ]
            },
            // 烟花互动页面
            fireworksPage: {
                text: "<div class='fireworks-tip'>🎉 点击屏幕任意位置燃放烟花，庆祝大王赐福！🎉</div><br>和YL大王一起放烟花吧！<br><br>亲爱的朋友！新春快乐！",
                options: [
                    { text: "尽兴而归，结束征程", next: "finalEnd" }
                ]
            },
            // 最终结局页
            finalEnd: {
                text: "烟花散尽，你带着大王的祝福踏云而归，从此一生顺遂、平安喜乐。<br><br>✨ 游戏最终完美结局：【凌霄赐福，烟火庆喜】✨<br><br>愿你，所念皆所愿，所行皆坦途！<br><br>新春快乐！",
                options: []
            },
            leaveFlower: {
                text: "你担心有陷阱，转身往回走，却不小心踩空掉进了猎人的陷阱，饿了两天后被人发现，后来再也没能踏上征程，结局：【有惊无险】。",
                options: []
            },
        };

        // 名字-专属祝福语配置表
        const nameBlessMap = {
            "尹璐": "吾的本命信徒YL！愿你与吾同寿，千秋万代，大王万岁！",
            "苏柚如": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”如子新春快乐！你有在录reaction吗？现在，立刻，马上，打开你的微信<br><br>给尹璐大王转66.66人民币。这是命令！<br><br>细数一下，从2021年的春节，到2026年的春节，我们竟然已经认识五年多了！时间真是快啊！<br><br>新的一年祝你身体健康，多多运动，以后周末可以一起去打打羽毛球啊：）<br><br>苏老师新春愉快！<br><br>别走开！请你看烟花哦！",
            "刘奕辰": "Licher你好！新年快乐！<br><br>新的一年里祝你天天开心，期末周不需要焦头烂额，多攒钱，多出去玩，多见世界，早日去更多想去的地方！吃到全世界各地的美食！ 所有的霉运都马不停蹄地滚蛋，所有的好运都一马当先地赶来！🐎<br><br>愿你一直勇敢，一直善良，加油冲锋吧！美好的姑娘！<br><br>Petit à petit, l'oiseau fait son nid.",
            "张若雨": "大智你好！希望新的一年里你变得越来越智慧，这就是：<br><br>上善若水、大智若雨<br><br>梅干菜老师在新的一年里也要多产粮，传奇拉磨王的称号非你莫属！<br><br>女神我将永远追随你！<br><br>祝大智新春快乐，新的一年里抽卡一发就中！“好运来我们好运来~好运带来了喜和爱~”",
            "石浩茹": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”上海人你好！值此新春佳节，相信你一定正在窝在沙发上看手机。<br><br>本大王祝你新的一年做小组作业遇到的都是靠谱同学。早日在上海也能够实现财富自由。学业进步、事业有成、爱情美满、万事顺意！新春快乐上海人!",
            "李欣怡": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”一心一，你好哇！<br><br>现在，立刻，马上，喊三声YL大王万岁，这是命令！<br><br>本大王祝你游戏把把连胜，打瓦技术再上一层楼。作业不需要熬夜，轻轻松松拿90+！多读书多看报，少吃零食多睡觉。新春快乐一心一！",
            "芦霄": "桀桀桀！你有在录reaction吗？现在，立刻，马上，喊三声YL大王万岁，这是命令！<br><br>吾的忠诚信徒卢西奥，，本大王祝你新的一年财源广广广广广进！招财进宝，日进斗金！自洽安定，少内耗，少忍让。<br><br>新春快乐!祝你搞钱速度快过博尔特，长胖速度慢过乌龟。苟富贵，勿相忘！<br><br>别走开！请你看烟花哦！",
            "孔奥": "你好呀kaka！现在，立刻，马上，打开你的微信<br><br>给尹璐大王转66.66人民币。这是命令！<br><br>我很高兴能有你这样的一位朋友，非常奇妙的经历！也非常感谢你在过去一年里在我犹豫不定时对我的鼓励，非常感谢！<br><br>值此新春佳节，祝你事业有成，学业顺利，爱情美满，内心安定！愿你一直勇敢，一直善良！ 所有的霉运都马不停蹄地滚蛋，所有的好运都一马当先地赶来！🐎新春快乐KAKA!",
            "杜丹青": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”蛋清老师你好哇！你通过了前面的层层关卡，说明你确实是一个聪明蛋。<br><br>现在，立刻，马上，打开你的微信<br><br>给尹璐大王转66.66人民币。这是命令！<br><br>值此新春佳节，祝丹青老师：<br><br>学业有成！立马保研！张张作业都留校！全国美展拿金奖！羽毛球技赛林丹，跑步跑过博尔特！<br><br>丹青老师新春快乐！",
            "马天娇": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”小马同学！新年快乐！！！哈哈哈！没想到吧！之前管你要地址是虚晃一枪！不知道这份礼物你会不会喜欢~<br><br>新的一年，愿你 “马” 上暴富，“马” 上健康，“马” 上开心，最重要的是 ——“马” 上找我玩！<br><br>祝你天天开心，广交良友，多见你想见的人！愿你一直勇敢，一直善良！新年快乐小马同学！<br><br>别走开！请你看烟花哦！",
            "张子鱼": "子鱼老师你好！法国怎么样？你那边应该是下午一两点？<br><br>现在，立刻，马上，<br><br>喊三声YL大王万岁，这是命令！<br><br>祝你新的一年多画画，多画好画，身体健康，少熬夜。天天开心，早日有能力可以不吸别人的二手烟。<br><br>愿你新的一年里万事顺意，学业有成，身体健康，心理自洽。<br><br>“我恭喜你发财~我恭喜你精彩~最好的请过来~不好的请走开~哦，礼多人不怪~<br><br>顺便，推荐一首歌：13 Jours en France。之前我写同人文的时候就是听着这首歌写的。感觉很适合巴黎。很感谢你给我发的巴黎的照片，看的时候感觉特别幸福。真好，巴黎这一百年来没怎么变样子。他们看到的世界跟现在的巴黎相差不大。（或许比现在条件更差：比如更臭hhh）透过照片甚至可以想象到镜头外他们的样子，幸福啊！<br><br>我非子鱼，亦知子鱼之乐<br><br>新年快乐哦！",
            "刘一潼": "叠个千纸鹤~再系个红飘带~愿善良的人们年年好运来~刘老师新年快乐！！！<br><br>之前跟你不是很熟，结果后来发现你是一个特别好特别有责任心的人！超级好的LYT！你是特别值得爱的，希望新的一年里可以“慧眼识猪”少为烂人耗心神！<br><br>祝刘老师，新年快乐！",
            "甘洛源": "嗨！这位聪明蛋朋友你好！相信前面的谜题对你来说没什么难度嘛~既然如此，现在还有一项神秘任务等待聪明的你来完成<br><br>凑近一点，这可是一个神秘的任务<br><br>打开你的微信，找到尹璐大王<br><br>给她转66.66！这是命令！<br><br>好吧甘洛源下士！听好了，接下来这是对你的新年祝福！（翻译腔）：<br><br>祝你早日实现各方面的独立，拥有一个属于你自己的房子，追寻到属于你的平和和安宁。<br><br>Petit à petit, l'oiseau fait son nid.<br><br>新春快乐。",
            "何昌澄": "嗨嗨嗨！昌哥你好哇！看来你已经解开了前面的谜题（虽然只有一个），你真是一个聪明蛋。客套话不多说了。新的一年，祝你专业能力节节高升！游戏水平秒杀职业！心想事成，万事顺意。<br><br>“叠个千纸鹤~再系个红飘带~愿善良的人们天天好运来~”<br><br>昌哥新年快乐！！！！",
            "杨皓博": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”HIIIIIIIIIIII!新年快乐！<br><br>小杨导过去一年辛苦了，最近过年吃美了吧。祝你新的一年里：少掉头发少熬夜，多睡大觉多开心。方案一稿过，需求不变更，老师不找茬，能力蹭蹭涨！<br><br>祝小杨导<br><br>新年快乐！",
            "张子通": "“恭喜你发财~恭喜你精彩~哦礼多人不怪~”亲爱的通通新年快乐!!!<br><br>祝你新的一年里，开心的日子要多于不开心的日子！多吃美食，多看美景。多想起我！最后一个尤其重要！<br><br>八方来财的智慧女神在新的一年里要财源广进，财运滚滚！所有的霉运都马不停蹄地滚蛋，所有的好运都一马当先地赶来！<br><br>新年快乐！！！",
            "楼馥菡": "嗨~新年快乐啊楼同学！<br><br>在过去的一年里，你365天都在鉴证，并且喜提：叛徒、特务、大军阀、反党分子、野心家等称号，本大王封你为鉴证达人！<br><br>新的一年里祝你少熬夜，继续保持一个积极理性的态度去观察世界！并且早日可以拥有与这世界上的一切不公作斗争的能力和锋芒！加油哦楼同学！理想主义万岁！",
            "黄京辉": "嗨大师！首先得感谢你当初在一个疑似发烧的夜晚教会了我怎么用AI来做HTML，可以说没有你就没有今天的这个网页啊！大师的这份春蚕到死丝方尽的精神真是十分地令人动容！（鼓掌）<br><br>过去的一年不可谓不精彩，先祝贺你目前取得的所有成就，确实是辛苦了！至于其他的，你也知道我要说什么，不过你开心就好。人总得依靠什么来让自己产生多巴胺。<br><br>新的一年里，祝你学业有成，再攀高峰！新春快乐！",
            "孙圣尧": "HI~SSY！新春快乐~祝你新的一年里有更多的时间和机会可以去见你想见的人。所有的霉运都马不停蹄地滚蛋，所有的好运都一马当先地赶来！🐎新年快乐SSY！",
            "谷沁垠": "嗨嗨嗨！蛋狗你好啊！现在是2026年2月8日。哈哈哈没想到吧，找你要地址是虚晃一枪！早知道不跟你说了。奈何本人小学生综合症发作，藏不住事思密达。<br><br>祝蛋狗，新的一年里所有的霉运都马不停蹄地滚蛋，所有的好运都一马当先地赶来！🐎哎呦！我好想去上海！搞民同怎么能不去上海呢！！！陪我去上海！！！新年快乐！",
            "李佳琪": "嗨~新年好呀LJQ！这算不算是一个小惊喜呢？<br><br>现在，立刻，马上，喊三声YL大王万岁，这是命令！<br><br>在过去的一年里，你充分地探索了人类吃喝玩乐的生命天赋，并且在此基础上还有全新的认知，非常好，很有精神！祝你在新的一年里，少熬夜少熬夜少熬夜，每天睡足七小时。新年快乐！！！",
            "俞博涵": "嗨！🐟老师你好啊！相信前面的东西是难不倒你的吧？<br><br>现在，立刻，马上，喊三声YL大王万岁，这是命令！<br><br>过去的事情终将过去，现在你拥有一个崭新的明天。<br><br>希望新的一年里少抽烟（吸烟有害健康（正色）心情不好可以寻找一些别的消遣方法呀，比如<br><br>打开你的微信<br><br>寻找到一个叫尹璐的联系人<br><br>然后<br><br>给她转账66.66并对她说一句新年快乐尊敬的尹璐大王！<br><br>好啦，新的一年里，愿你 “马” 上暴富，“马” 上健康，“马” 上开心，最重要的是 ——“马” 上找我玩！<br><br>🐟老师新年快乐！现在快许个愿吧，新春赐福，百无禁忌！<br><br>还有，现在，打开你的微信，找到一个叫尹璐的联系人，给她发送一个地址，你就可以领取到你的生日礼物啦~<br><br>别走开，请你看烟花哦！",
            "陈思佳": "“耶咦耶咦耶咦耶哦哦~耶咦耶咦耶咦耶哦哦~”嗨~亲爱的陈思佳女士，有没有感到一丝惊喜~<br><br>现在，立刻，马上，<br><br>喊三声YL大王万岁，这是命令！<br><br>新的一年里，祝你财源广进，多读书多看报，少吃零食多睡觉。好运来好运来！",
            "高圣洁": "嗨！新年快乐！虽然你在加拿大那边已经不过春节了。但是还是祝你新春愉快！祝你新的一年里平定自洽，学业精进，万事顺意！新年快乐！",
            "王艺涵": "hi！相信前面的东西都难不倒你吧hh!这算不算是一个小惊喜呢？亲爱的王艺涵新年快乐！<br><br>祝你新的一年里少熬夜，少焦虑，身体健康，学业顺遂。新春快乐！",
            "": "啥都不写就想要祝福吗？好吧，祝你天天开心，长命百岁！"
        };
        const defaultBless = "吾的忠实信徒，愿你一生明朗，万事顺遂，凌霄殿永为你遮风挡雨！";

        // ########## 优化版烟花+星星特效核心代码 ##########
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let fireworks = [];    // 存储爆炸粒子
        let rockets = [];       // 存储升空火箭
        let stars = [];         // 存储星星
        let isFireworksActive = false; // 烟花是否激活
        const gameContainer = document.getElementById('gameContainer'); // 游戏容器

        // 适配画布大小
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            // 重新生成星星（窗口大小变化时）
            createStars();
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // 生成星星（随机分布在画布上）
        function createStars() {
            stars = [];
            // 星星数量从200减到80，更稀疏
            const starCount = 80;
            for (let i = 0; i < starCount; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    // 星星大小从1-3px缩到0.5-1.5px，更小巧
                    size: Math.random() * 1 + 0.5,
                    // 闪烁透明度：0.2-0.8 更柔和
                    alpha: Math.random() * 0.6 + 0.2,
                    // 闪烁速度放慢，更自然
                    alphaSpeed: (Math.random() - 0.5) * 0.005,
                    // 星星颜色：全白色，更纯净
                    color: 'rgba(255,255,255,{alpha})'
                });
            }
        }

        // 更新星星（实现闪烁效果）
        function updateStars() {
            stars.forEach(star => {
                // 更新透明度（闪烁效果）
                star.alpha += star.alphaSpeed;
                // 边界检测：透明度不能小于0.1或大于1
                if (star.alpha <= 0.1) {
                    star.alpha = 0.1;
                    star.alphaSpeed = -star.alphaSpeed; // 反向
                }
                if (star.alpha >= 1) {
                    star.alpha = 1;
                    star.alphaSpeed = -star.alphaSpeed; // 反向
                }
            });
        }

        // 绘制星星
        function drawStars() {
            stars.forEach(star => {
                ctx.save();
                // 替换颜色中的alpha占位符
                const color = star.color.replace('{alpha}', star.alpha);
                ctx.fillStyle = color;
                ctx.beginPath();
                // 绘制圆形星星
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            });
        }

        // 生成随机颜色（重点：金红色系为主，保留随机性）
        function getRandomColor() {
            // 优先生成红/金/橙/粉系颜色（占比80%+）
            const colorType = Math.random();
            let h;
            
            if (colorType < 0.4) {
                // 40% 红色系 (0-30°)
                h = Math.floor(Math.random() * 30);
            } else if (colorType < 0.7) {
                // 30% 金色/橙色系 (30-60°)
                h = Math.floor(Math.random() * 30) + 30;
            } else if (colorType < 0.9) {
                // 20% 粉色/玫红系 (330-360°)
                h = Math.floor(Math.random() * 30) + 330;
            } else {
                // 10% 其他喜庆色（紫/黄）
                h = Math.floor(Math.random() * 40) + 280;
            }
            
            // 金色调调整：亮度70-90%，饱和度80-100%
            const s = h >=30 && h <=60 ? Math.floor(Math.random() * 20) + 80 : 100;
            const l = h >=30 && h <=60 ? Math.floor(Math.random() * 20) + 70 : Math.floor(Math.random() * 20) + 60;
            
            return `hsl(${h}, ${s}%, ${l}%)`;
        }

        // 升空火箭类（烟花轨迹）
        class Rocket {
            constructor(x, y) {
                this.x = x;
                this.y = canvas.height; // 从底部升空
                this.targetY = y;       // 爆炸目标高度
                this.speed = Math.random() * 8 + 12; // 升空速度
                this.alpha = 1;
                this.color = '#fff';    // 火箭轨迹为亮白色
            }

            update() {
                // 向上飞行
                this.y -= this.speed;
                // 到达目标高度或超出屏幕则爆炸
                if (this.y <= this.targetY || this.y < 0) {
                    // 生成爆炸粒子
                    createExplosion(this.x, this.y);
                    // 移除当前火箭
                    return true;
                }
                return false;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                // 绘制尾迹
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + 10);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = 'rgba(255,255,255,0.5)';
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.restore();
            }
        }

        // 爆炸粒子类（金红色粒子略大）
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.speed = Math.random() * 8 + 4;  // 爆炸速度
                this.angle = Math.random() * Math.PI * 2; // 随机角度
                this.gravity = 0.06;                 // 重力
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.alpha = 1;
                this.decay = Math.random() * 0.01 + 0.005; // 衰减速度
                this.color = getRandomColor();
                // 粒子大小微调，整体稍小
                this.size = this.color.includes('45%') || this.color.includes('50%') 
                    ? Math.random() * 3 + 2  // 金色粒子：2-5px
                    : Math.random() * 2 + 1;  // 其他粒子：1-3px
            }

            update() {
                // 应用重力
                this.vy += this.gravity;
                // 空气阻力
                this.vx *= 0.97;
                this.vy *= 0.97;
                
                this.x += this.vx;
                this.y += this.vy;
                // 透明度衰减
                this.alpha -= this.decay;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                
                // 为金色粒子添加渐变高光
                if (this.color.includes('45%') || this.color.includes('50%')) {
                    const gradient = ctx.createRadialGradient(
                        this.x, this.y, 0,
                        this.x, this.y, this.size
                    );
                    gradient.addColorStop(0, '#fff');
                    gradient.addColorStop(1, this.color);
                    ctx.fillStyle = gradient;
                } else {
                    ctx.fillStyle = this.color;
                }
                
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        // 创建爆炸效果（粒子数从100-150减到60-90，密度降低）
        function createExplosion(x, y) {
            const count = Math.floor(Math.random() * 30) + 60;
            for (let i = 0; i < count; i++) {
                fireworks.push(new Particle(x, y));
            }
        }

        // 动画循环（包含星星+烟花）
        function animateFireworks() {
            if (!isFireworksActive) return;
            
            // 半透明背景，实现拖影效果
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 先绘制星星（底层）
            updateStars();
            drawStars();
            
            // 再绘制火箭和烟花（上层）
            for (let i = rockets.length - 1; i >= 0; i--) {
                const rocket = rockets[i];
                const isExploded = rocket.update();
                rocket.draw();

                if (isExploded) {
                    rockets.splice(i, 1);
                }
            }

            for (let i = fireworks.length - 1; i >= 0; i--) {
                const particle = fireworks[i];
                particle.update();
                particle.draw();

                if (particle.alpha <= 0) {
                    fireworks.splice(i, 1);
                }
            }
            
            requestAnimationFrame(animateFireworks);
        }

        // 点击画布触发烟花（每次生成的火箭数从2-4减到1-2，更稀疏）
        canvas.addEventListener('click', (e) => {
            if (isFireworksActive) {
                const rocketCount = Math.floor(Math.random() * 2) + 1;
                for(let i=0; i<rocketCount; i++){
                    const offsetX = Math.random() * 60 - 30;
                    const offsetY = Math.random() * 40 - 20;
                    rockets.push(new Rocket(e.clientX + offsetX, e.clientY + offsetY));
                }
            }
        });

        // ########## 游戏核心逻辑 ##########
        const storyBox = document.getElementById('storyBox');
        const optionsBox = document.getElementById('optionsBox');
        let currentNode = 'start';
        let userName = '';

        initGame();
        function initGame() {
            renderStory(currentNode);
        }

        function renderStory(nodeId) {
            const node = storyData[nodeId];
            if (!node) {
                storyBox.innerHTML = "剧情加载失败，未找到该节点！";
                optionsBox.innerHTML = "";
                return;
            }

            // 动态生成祝福语文本
            if (nodeId === "blessPage") {
                const blessText = nameBlessMap[userName] || defaultBless;
                node.text = `YL大王看着你，郑重念出祝福：<br><br><span class="bless-text">${blessText}</span><br><br>此祝福伴你一生，祝年年有今日，岁岁有今朝。天涯咫尺常相见。`;
            }

            // 控制烟花/星星显示/隐藏 + 切换容器样式
            if (nodeId === "fireworksPage") {
                canvas.style.display = 'block';
                isFireworksActive = true;
                gameContainer.classList.add('fireworks-mode'); // 添加烟花模式样式
                createStars(); // 生成星星
                animateFireworks(); // 启动烟花+星星动画
            } else {
                canvas.style.display = 'none';
                isFireworksActive = false;
                gameContainer.classList.remove('fireworks-mode'); // 移除烟花模式样式
                // 清空烟花粒子和星星，避免残留
                fireworks = [];
                rockets = [];
                stars = [];
            }

            // 展示剧情文本
            storyBox.innerHTML = node.text;
            optionsBox.innerHTML = "";

            // 渲染选项/输入框
            if (node.inputQuiz) {
                renderInputQuiz(node.inputQuiz);
            } else if (node.options.length > 0) {
                node.options.forEach(option => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = option.text;
                    btn.onclick = () => {
                        currentNode = option.next;
                        renderStory(currentNode);
                    };
                    optionsBox.appendChild(btn);
                });
            } else {
                optionsBox.innerHTML = '<p class="end-text">游戏结束，刷新页面重新开始</p>';
            }
        }

        function renderInputQuiz(quiz) {
            const input = document.createElement('input');
            input.className = 'answer-input';
            input.placeholder = '请输入答案后提交';
            input.type = 'text';

            const submitBtn = document.createElement('button');
            submitBtn.className = 'submit-btn';
            submitBtn.innerText = '提交答案';

            const errorTip = document.createElement('p');
            errorTip.className = 'error-tip';
            errorTip.style.display = 'none';

            const inputContainer = document.createElement('div');
            inputContainer.className = 'input-box';
            inputContainer.appendChild(input);
            inputContainer.appendChild(submitBtn);
            optionsBox.appendChild(inputContainer);
            optionsBox.appendChild(errorTip);

            submitBtn.onclick = () => {
                const userAnswer = input.value.trim();
                if (currentNode === "inputName") {
                    userName = userAnswer;
                }
                if (quiz.correctAnswer === "*" || userAnswer === quiz.correctAnswer) {
                    currentNode = quiz.correctNext;
                    renderStory(currentNode);
                } else {
                    errorTip.style.display = 'block';
                    errorTip.innerText = quiz.tip;
                    input.value = '';
                    input.focus();
                }
            };

            input.onkeydown = (e) => {
                if (e.key === 'Enter') submitBtn.click();
            };
        }
    </script>
</body>
</html>